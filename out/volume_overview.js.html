<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Frontend Documentation</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: volume/overview.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// Generated by CoffeeScript 1.12.7

/**
 * Volume view overview section
 * @module
 */
'use strict';
app.directive('volumeOverview', [
  'constantService', function(constants) {
    var generateAssetcount, generateReleasesummary, generateSummary;
    generateSummary = function(volume) {
      var Gender, Participant, c, ci, g, i, len, r, ref, ref1, ref2, results, ri, summary;
      volume.summary = summary = {
        sessions: 0,
        shared: 0,
        agemin: 2e308,
        agemax: -2e308,
        agesum: 0,
        ages: 0,
        participants: 0
      };
      Participant = constants.categoryName.participant;
      Gender = Participant.metricName.gender.id;
      Participant = Participant.id;
      ref = volume.containers;
      for (ci in ref) {
        c = ref[ci];
        if (!(!c.top)) {
          continue;
        }
        summary.sessions++;
        if (c.release >= constants.release.SHARED) {
          summary.shared++;
        }
        ref1 = c.records;
        for (i = 0, len = ref1.length; i &lt; len; i++) {
          r = ref1[i];
          if (!('age' in r &amp;&amp; volume.records[r.id].category === Participant)) {
            continue;
          }
          if (r.age &lt; summary.agemin) {
            summary.agemin = r.age;
          }
          if (r.age > summary.agemax) {
            summary.agemax = r.age;
          }
          summary.agesum += r.age;
          summary.ages++;
        }
      }
      summary.agemean = summary.agesum / summary.ages;
      ref2 = volume.records;
      results = [];
      for (ri in ref2) {
        r = ref2[ri];
        if (r.category === Participant) {
          summary.participants++;
          if (g = r.measures[Gender]) {
            summary.genders || (summary.genders = {});
            if (summary.genders[g]) {
              results.push(summary.genders[g]++);
            } else {
              results.push(summary.genders[g] = 1);
            }
          } else {
            results.push(void 0);
          }
        } else {
          results.push(void 0);
        }
      }
      return results;
    };
    generateReleasesummary = function(volume) {
      var combineArray, fileArrMat, fileArrSess, generateArray, k, key, ref, results, summary, v, value;
      volume.releasesummary = summary = {
        'sessions': {
          unreleased: 0,
          "private": 0,
          shared: 0,
          excerpts: 0,
          "public": 0
        },
        'materials': {
          unreleased: 0,
          "private": 0,
          shared: 0,
          excerpts: 0,
          "public": 0
        }
      };
      fileArrSess = [];
      fileArrMat = [];
      generateArray = function(obj, array) {
        var k, results, v;
        results = [];
        for (k in obj) {
          v = obj[k];
          if (constants.release[v.classification] === void 0) {
            if (constants.release[v.container.release] === void 0) {
              results.push(array.push('private'));
            } else {
              results.push(array.push(constants.release[v.container.release].toLowerCase()));
            }
          } else {
            results.push(array.push(constants.release[v.classification].toLowerCase()));
          }
        }
        return results;
      };
      combineArray = function(array, string) {
        var results, x;
        results = [];
        for (x in array) {
          results.push(summary[string][array[x]]++);
        }
        return results;
      };
      ref = volume.containers;
      for (key in ref) {
        value = ref[key];
        if (Object.keys(value.assets).length > 0) {
          if (value.top === true) {
            generateArray(value.assets, fileArrMat);
          } else {
            generateArray(value.assets, fileArrSess);
          }
        }
      }
      combineArray(fileArrMat, 'materials');
      combineArray(fileArrSess, 'sessions');
      results = [];
      for (key in summary) {
        value = summary[key];
        results.push((function() {
          var results1;
          results1 = [];
          for (k in value) {
            v = value[k];
            if (v === 0) {
              results1.push(delete summary[key][k]);
            } else {
              results1.push(void 0);
            }
          }
          return results1;
        })());
      }
      return results;
    };
    generateAssetcount = function(volume) {
      volume.assetCount = Object.keys(volume.assets).length;
      return volume.assetCount;
    };
    return {
      restrict: 'E',
      templateUrl: 'volume/overview.html',
      scope: false,
      link: {
        pre: function($scope) {
          if (!$scope.volume.summary) {
            generateSummary($scope.volume);
          }
          generateReleasesummary($scope.volume);
          generateAssetcount($scope.volume);
        }
      }
    };
  }
]);

app.directive('releaseTable', [
  function() {
    return {
      restrict: 'E',
      link: function($scope, $elem) {
        var k, key, ref, table, tbody, th, trow, v, value;
        table = angular.element($elem[0]);
        table.append('&lt;thead>&lt;tr>&lt;th>File Type&lt;/th>&lt;th>Release Level&lt;/th>&lt;th># of Files&lt;/th>&lt;/tr>&lt;/thead>&lt;tbody>&lt;/tbody>');
        tbody = table.find('tbody');
        ref = $scope.volume.releasesummary;
        for (key in ref) {
          value = ref[key];
          if (Object.keys(value).length > 0) {
            for (k in value) {
              v = value[k];
              if (k === Object.keys(value)[0]) {
                th = '&lt;tr>&lt;th rowspan="' + Object.keys(value).length + '">' + key + '&lt;/th>&lt;th>' + k + '&lt;/th>&lt;td>' + v + '&lt;/td>&lt;/tr>';
                tbody.append(th);
              } else if (Object.keys(value).length > 1) {
                trow = '&lt;tr>&lt;th>' + k + '&lt;/th>&lt;td>' + v + '&lt;/td>&lt;/tr>';
                tbody.append(trow);
              } else {
                trow = '';
              }
            }
          }
        }
      }
    };
  }
]);

//# sourceMappingURL=overview.js.map
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Back to Homepage</a></h2><h3>Directives</h3><ul><li><a href="module-directive_clickElsewhere.html">directive/clickElsewhere</a></li><li><a href="module-directive_form.html">directive/form</a></li><li><a href="module-site_activity.html">site/activity</a></li><li><a href="module-site_activityChange.html">site/activityChange</a></li><li><a href="module-site_commentReply.html">site/commentReply</a></li><li><a href="module-site_displayAge.html">site/displayAge</a></li><li><a href="module-site_errors.html">site/errors</a></li><li><a href="module-site_figure.html">site/figure</a></li><li><a href="module-site_frame.html">site/frame</a></li><li><a href="module-site_inputAge.html">site/inputAge</a></li><li><a href="module-site_inputCompleter.html">site/inputCompleter</a></li><li><a href="module-volume_accessGrant.html">volume/accessGrant</a></li><li><a href="module-volume_accessSearch.html">volume/accessSearch</a></li><li><a href="module-volume_assist.html">volume/assist</a></li><li><a href="module-volume_cite.html">volume/cite</a></li><li><a href="module-volume_comments.html">volume/comments</a></li><li><a href="module-volume_design.html">volume/design</a></li><li><a href="module-volume_editAccess.html">volume/editAccess</a></li><li><a href="module-volume_editFunding.html">volume/editFunding</a></li><li><a href="module-volume_editLinks.html">volume/editLinks</a></li><li><a href="module-volume_editOverview.html">volume/editOverview</a></li><li><a href="module-volume_excerpts.html">volume/excerpts</a></li><li><a href="module-volume_filter.html">volume/filter</a></li><li><a href="module-volume_fundingGrant.html">volume/fundingGrant</a></li><li><a href="module-volume_fundingSearch.html">volume/fundingSearch</a></li><li><a href="module-volume_list.html">volume/list</a></li><li><a href="module-volume_metadata.html">volume/metadata</a></li><li><a href="module-volume_meter.html">volume/meter</a></li><li><a href="module-volume_meterCanvas.html">volume/meterCanvas</a></li><li><a href="module-volume_overview.html">volume/overview</a></li><li><a href="module-volume_owners.html">volume/owners</a></li><li><a href="module-volume_pivot.html">volume/pivot</a></li><li><a href="module-volume_showInvestigators.html">volume/showInvestigators</a></li><li><a href="module-volume_slot.html">volume/slot</a></li><li><a href="module-volume_spreadsheet.html">volume/spreadsheet</a></li></ul><h3>Services</h3><ul><li><a href="analyticService.html">analyticService</a></li><li><a href="authService.html">authService</a></li><li><a href="constantService.html">constantService</a></li><li><a href="displayService.html">displayService</a></li><li><a href="messageService.html">messageService</a></li></ul><h3>Controllers</h3><ul><li><a href="site_home.html">site/home</a></li><li><a href="volume_activity.html">volume/activity</a></li><li><a href="volume_csv.html">volume/csv</a></li><li><a href="volume_edit.html">volume/edit</a></li><li><a href="volume_search.html">volume/search</a></li><li><a href="volume_slotActivity.html">volume/slotActivity</a></li><li><a href="volume_view.html">volume/view</a></li><li><a href="volume_zip.html">volume/zip</a></li></ul><h3>Functions</h3><ul><li><a href="-_anonymous_-pre-checkDirty.html">checkDirty</a></li><li><a href="-_anonymous_-pre-form.$setUnsubmitted.html">$setUnsubmitted</a></li><li><a href="-_anonymous_-pre-form.resetAll.html">resetAll</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu May 17 2018 12:01:00 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
