<article class="view search-view">
  <div class="wrap">
    <div class="row">
      <div class="col">
        <h3>
          <span>Search </span>
          <ng-form isolate>
            <input class="search-input" type="search" ng-model="searchBoxQuery" key-enter="searchBox()"/>
          </ng-form>
        </h3>
      </div>
    </div>
    <div class="search-filter col-desktop-4 col-tablet-3 col-mobile-6">
      <select multiple="multiple" size="10" ng-model="selectedType" ng-options="t for t in typeDisplay" ng-click="partyVolBoxClick()"></select>
      <select multiple="multiple" size="10" ng-model="selectedFilter" ng-options="s for s in filterDisplay" ng-click="filterBoxClick()"></select>
      <!-- <select multiple="multiple" size="10" ng-model="selectedVolume" ng-options="result.title_t for result in results.docs"></select> -->
    </div> 
    <div class="col-desktop-10 col-tablet-6 col-mobile-6">     
      <p>Number of results found: {{totalCount}}</p>
      <span ng-if="suggestedQuery.length > 0">
        <p>Did you mean <a ng-click="search(suggestedQuery)">{{suggestedQuery}}</a>?</p>
      </span>
      <!--<p>Showing results {{results.start + 1}} to {{results.start + results.docs.length}}</p>-->
      <div ng-if="partyCount > 0">
        <h3>Users</h3>
        <div class="row search-party-results">  
          <!-- This is where we return what we want-->
          <aside class="col-desktop-5 col-tablet-4 col-mobile-6 portrait ng-cloak" ng-repeat="result in partyResults.docs">
            <a ng-href="{{::page.router.party([result.party_id_i])}}">
              <figure class="figure-avatar" ng-class="::{inst: party.institution}">
                <img ng-src="{{::page.router.partyAvatar([result.party_id_i, size || 56], {})}}">
              </figure>
            </a>
            <div class="portrait-info">
              <a class="portrait-name" ng-href="{{::page.router.party([result.party_id_i])}}" ng-bind="::result.party_pre_name_s + ' ' + result.party_name_s"></a>
              <span class="portrait-extra" ng-bind="::result.party_affiliation_s"></span>
            </div>
          </aside>
        </div>
      </div>
      <div ng-if="volumeCount > 0">
        <h3>Volumes</h3>
        <ul class="row search-volume-results">
          <li ng-repeat="result in volumeResults.docs">
            <!-- This is where we return what we want-->
            <h1 class="search-volume-result-title"><a ng-href="volume/{{result.volume_id_i}}">{{result.title_t}}</a></h1>

            <span ng-bind="formVolumeResult(result)"></span>
            <span ng-if="result.volume_keywords_ss.length > 0" class="inline-block"><br>Keywords: </span>
            <ul class="inline-block comma">
              <li ng-repeat="k in result.volume_keywords_ss">{{k}}</li>
            </ul>

            <button class="neutral mini">
              <span ng-if="retrievedContainers[result.volume_id_i] === undefined" ng-click="searchContainers(result.volume_id_i)">Expand</span>
              <span ng-if="retrievedContainers[result.volume_id_i] !== undefined" ng-click="clearContainers(result.volume_id_i)">Hide</span>
            </button>

            <span ng-if="retrievedContainers[result.volume_id_i] !== undefined">
              <!-- Keywords: <span ng-repeat="k in result.volume_keywords_ss">{{k + ", "}}</span><br> -->
              <ul class="search-volume-containers" ng-if="retrievedContainers[result.volume_id_i].length > 0">
                <li ng-repeat="container in retrievedContainers[result.volume_id_i]">
                  <a ng-href="volume/{{result.volume_id_i}}/slot/{{container.container_id_i}}">{{container.container_text_t? container.container_text_t: 'no text'}}</a>
                </li>
              </ul>
            </span>

          </li>
        </ul>
      </div>
      <span ng-if="partyCount <= 0 && volumeCount <= 0">
        No results found.
      </span>
      <div class="search-pages">
        <span ng-if="prev">
          <a ng-if="prev" ng-click="prev()">&lt; </a>
        </span>
        <b ng-repeat="i in pageRange">
          <b ng-if="number == i">| {{i}} </b>
          <span ng-if="number != i">
            <a ng-click="goToPage(i)">| {{i}} </a>
          </span>
        </b>
        |
        <span ng-if="next">
          <a ng-click="next()"> &gt;</a>
        </span>
      </div>
    </div>
  </div>
</article>
