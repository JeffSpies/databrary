<ol>
  <li ng-repeat="act in ::activity">
    {{act.time | date:'medium'}}
    <portrait ng-if="act.user >= 0" load-party="act.user"></portrait>
    {{act.action}}

    <dl ng-if="::!!act.party">
      <span activity-change="act.party.prename" title-message="prename" ng-bind="::value"></span>
      <span activity-change="act.party.sortname" title-message="sortname" ng-bind="::value"></span>
      <span activity-change="act.party.orcid" title-message="orcid" ng-bind="::value"></span>
      <span activity-change="act.party.affiliation" title-message="affiliation" ng-bind="::value"></span>
      <span activity-change="act.party.url" title-message="party.edit.url.title" ng-bind="::value"></span>
    </dl>

    <dl ng-if="::!!act.account">
      <dt>Login</dt>
      <dd ng-bind="::act.ip"></dd>
      <span activity-change="act.account.email" title-message="email" ng-bind="::value"></span>
      <dt ng-if="::act.account.password !== act.old.password">Password</dt>
    </dl>

    <dl ng-if="::!!act.authorize">
      <dt>Authorization</dt>
      <dd>
        <a ng-href="{{::act.authorize.party.route()}}" class="permission-auth-username" ng-bind="::act.authorize.party.name"></a><wbr>
        <span class="permission-auth-email" ng-if="::act.authorize.party.email" ng-bind="::act.authorize.party.email"></span>
      </dd>
      <span activity-change="act.authorize.site" title-message="auth.site.edit" message="auth.site.{{::page.constants.permission[value]}}.title"></span>
      <span activity-change="act.authorize.member" title-message="auth.member.edit" message="auth.member.{{::page.constants.permission[value]}}.title"></span>
    </dl>

    <dl ng-if="::!!act.volume">
      <span activity-change="act.volume.name" title-message="volume.name" ng-bind="::value"></span>
      <span activity-change="act.volume.alias" title-message="volume.alias" ng-bind="::value"></span>
      <div activity-change="act.volume.body" title-message="volume.body" block ng-bind-html="::value | format"></div>
    </dl>

    <dl ng-if="::!!act.access">
      <dt>Access</dt>
      <dd>
        <a ng-href="{{::act.access.party.route()}}" class="permission-auth-username" ng-bind="::act.access.party.name"></a><wbr>
        <span class="permission-auth-email" ng-if="::act.access.party.email" ng-bind="::act.access.party.email"></span>
      </dd>
      <span activity-change="act.access.individual" title="Level" ng-init="perm=page.constants.permission[value]">
        <span class="icon user-access" ng-class="::perm"></span> 
        <span message="access.edit.{{::perm}}.title"></span>
      </span>
      <span activity-change="act.access.children" title="Extend">
        <span ng-if="value" class="icon network"></span>
      </span>
    </dl>

    <dl ng-if="::!!act.container">
      <span activity-change="act.container.name" title="Name" ng-bind="::value"></span>
      <span activity-change="act.container.date" title="Test date" ng-bind="::value"></span>
    </dl>

    <dl ng-if="::!!act.release">
      <dt ng-if="::!act.release.segment.full">Segment</dt>
      <dd ng-if="::!act.release.segment.full">{{::act.release.segment}}</dd>
      <span activity-change="act.release.release" title="Release" ng-init="release=page.constants.release[value]">
        <span class="icon release" ng-class="::release"></span>
        {{::release}}
      </span>
    </dl>

    <dl ng-if="::!!act.assets">
      <dt>File</dt>
      <dd>
        <!-- img ng-src="{{::page.router.assetThumb([act.old.id, 24])}}" -->
        {{::act.assets.id}}
      </dd>
      <span activity-change="act.assets.segment" title="Position">
        {{::value[0] | timecode}}
      </span>
      <dt ng-if="::act.assets.replace">Replacing</dt>
      <dt ng-if="::act.assets.transcode">Automatically converted from</dt>
      <dd ng-if="::act.assets.replace || act.assets.transcode">
        <!-- img ng-src="{{::act.old.thumbRoute(24)}}" -->
        <!-- a class="icon download button" ng-href="{{::act.old.route()}}" -->
        {{::act.old.id}}
      </dd>
    </dl>

    <dl ng-if="::!!act.asset">
      <dt>File</dt>
      <dd>{{::act.asset.id}}</dd>
      <span activity-change="act.asset.name" title-message="asset.name.title" ng-bind="::value"></span>
      <span activity-change="act.asset.classification" title-message="asset.classification" ng-init="release=page.constants.release[value]">
        <span class="icon release" ng-class="::release"></span>
        {{::release}}
      </span>
    </dl>

    <dl ng-if="::!!act.excerpt">
      <dt>Highlight</dt>
      <dd>
        {{::act.excerpt.id}}: 
        {{::act.excerpt.segment.l | timecode}} &ndash; {{::act.excerpt.segment.u | timecode}}
      </dd>
      <span activity-change="act.excerpt.excerpt" title="Release" ng-init="release=page.constants.release[value]">
        <span class="icon release" ng-class="::release"></span>
        {{::release}}
      </span>
    </dl>

  </li>
</ol>
