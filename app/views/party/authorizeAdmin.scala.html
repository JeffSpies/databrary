@(parties : Seq[Party], pending : Seq[PartyController.AuthorizeAdminForm], active : Seq[Authorize], expired : Seq[Authorize])(implicit request : SiteRequest[_])

@implicitField = @{
    helper.FieldConstructor(widget.tag.tableFieldConstructor.f)
}

@authorizeList(authorize : Seq[Authorize]) = {
    <table>
    <thead>
	<tr>
	    <th>Parent</th>
	    <th>Child</th>
	    <th>Info</th>
	    <th>Site</th>
	    <th>Member</th>
	    <th>Expires</th>
	</tr>
    </thead>

    <tbody>
	@authorize.map { authorize =>
	<tr>
	    <td>@display(authorize.parent)</td>
	    <td>@display(authorize.child)
		@authorize.child.email.map { e =>
		    <br/>&lt;@e&gt;
		}
	    </td>
	    <td>@authorize.info</td>
	    <td>@authorize.site</td>
	    <td>@authorize.member</td>
	    <td>@authorize.expires</td>
	</tr>
	}
    </tbody>
    </table>
}

@template.action("Admin Authorizations") {
    <h3>Parties</h3>
    <ul>
    @parties.map { party =>
	<li>@display(party)</li>
    }
    </ul>

    <h3>Pending</h3>

    <table>
    <thead>
	<tr>
	    <th>Parent</th>
	    <th>Child</th>
	    <th>Info</th>
	    <th>Site</th>
	    <th>Member</th>
	    <th>Expires</th>
	    <th>Action</th>
	</tr>
    </thead>

    <tbody>
	@pending.map { form =>
	@widget.tag.form(form) {
	<tr>
	    <td>@display(form.authorize.parent)</td>
	    <td>@display(form.authorize.child)</td>
	    @widget.tag.inputText(form.info())
	    @widget.enumSelect(form.site(), Permission)
	    @widget.enumSelect(form.member(), Permission)
	    @widget.tag.inputDate(form.expires())
	    <td>
		@widget.formErrors(form)
		<button type='submit' class="button second">@{if(form.pending) "Authorize" else "Update"}</button>
		<button class="button first" name='delete' value='true'>@{if(form.pending) "Deny" else "Revoke"}</button>
	    </td>
	</tr>
	}
	}
    </tbody>
    </table>

    <h3>Active</h3>
    @authorizeList(active)

    <h3>Expried</h3>
    @authorizeList(expired)
}
