@(party : Party)(implicit request : RequestObject[SitePage]#Site[_])

@script = {
    dbjs.fadeOff('.volume_roll a', '.body', '.thumb');
}

@template.crud("Profile: " + party.name, js = script) {
    <article id="profile_@party.id.unId" class="party view">
        <div class="modal_content">
	    <div class="row">
		<section class="personal col-desktop-2 push-desktop-2 col-laptop-2 col-tablet-2 col-mobile-6">
		@dbrary.cast[Account](party).map { a =>
		    <img src="@display.gravatarUrlByEmail(a.email, 144)" alt="party.name" class="avatar">

		    <div class="connect">
			<h2>Connect</h2>

			<ul class="flat">
			    @if(request.access >= Permission.VIEW) {
				@if(a.email != "") {
				    <li><a href="mailto:@a.email" title="Email @party.name"><img src="@routes.Assets.at("images/social/16px/email.png")" alt="Email @party.name">email</a></li>
				}
			    }

			    @party.orcid.map { o =>
				<li><a href="@o.uri" title="@party.name on ORCID"><img src="@routes.Assets.at("images/social/16px/orcid.png")" alt="@party.name on ORCID">@o.toString</a></li>
			    }
			</ul>
		    </div>
		}

		@if(party.authorizeParents().nonEmpty) {
		    <div class="memberships">
			<h2>Memberships</h2>

			<ul class="flat">
			@party.authorizeParents().map { t =>
			    <li>@display(t.parent)</li>
			}
			</ul>
		    </div>
		}

		@if(party.authorizeChildren().nonEmpty) {
		    <div class="memberships">
		    @if(dbrary.cast[Account](party)) { <h2>Dependents</h2> } else { <h2>Members</h2> }

			<ul class="flat">
			@party.authorizeChildren().map { t =>
			    <li>@display(t.child)</li>
			}
			</ul>
		    </div>
		}
		</section>

		<div class="content col-desktop-10 col-laptop-10 col-tablet-7 col-mobile-6">
		    <section class="volume_list">
			    <h2>Studies</h2>

			    @party.volumeAccess(Permission.CONTRIBUTE).map { a =>
				    @widget.volumeSmall(a.volume)
			    }
		    </section>

		    <div class="row">
		    @region.comments(None, dbrary.cast[Account](party).fold(Nil : Seq[models.Comment])(_.comments))
		    </div>
		</div>
	    </div>
	</div>
    </article>
}
