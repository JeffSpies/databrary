@()(implicit request: RequestObject[Volume]#Site[_])

    @script = {
	dbjs.tabs('.tabset', '.tab', '.view');
    }

@defining((request.obj, request.obj.toplevelAssets groupBy { sa =>
	if(!sa.checkPermission(Permission.DOWNLOAD)) 'o' else sa.format.mimeSubTypes._1 match {
	    case "image" => 'i'
	    case "video" => 'v'
	    case "audio" => 'a'
	    case _ => 'o'
	}
})) { case (volume, assets) =>
    @template.crud("Volume: " + volume.name, js = script) {
        @widget.panels.volume(volume)
        @widget.panels.browser(volume)
        @widget.panels.materials(volume.toplevelAssets)()
        @widget.panels.publications(volume.citations)
        @widget.panels.people(volume)
        @widget.panels.tags(volume.topSlot, Some(volume))
        @widget.panels.comments(Some(request.obj.topSlot), Some((routes.Slot.comment(volume.id, volume.topSlot.id), controllers.Slot.commentForm)), volume.comments)
    }
}
