@(title : String = "The Databrary Project", redirect : Boolean = false)(requestOption: Option[SiteRequest[_]] = None)(body : Html)

@import play.api._
@import play.api.Play.current

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>@title || Databrary: The Open Data Library for Developmental Science</title>

    <!-- icons -->
    <link rel="shortcut icon" href="@routes.Assets.at("icons/favicon.png")">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="@routes.Assets.at("icons/apple-touch-icon-114x114.png")">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="@routes.Assets.at("icons/apple-touch-icon-72x72.png")">
    <link rel="apple-touch-icon-precomposed" href="@routes.Assets.at("icons/apple-touch-icon.png")">

    <!-- css -->
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/app.min.css")">

    <!-- js -->
    @helper.requireJs(core = routes.Assets.at("javascripts/require.js").url, module = routes.Assets.at("javascripts/app/app").url)

    <!-- redirect -->
    <script>
        window.$play = {};

	@requestOption.flatMap(RequestObject.cast).flatMap(cast[SiteObject](_)).map { obj =>
        window.$play.object = @format.raw(play.api.libs.json.Json.toJson(obj.json).toString);
        }

        @if(redirect) {
        window.$play.redirect = true;
        }
    </script>

    <!-- more -->
</head>

<body class="@if(Play.isDev){dev}">
    <section toolbar id="toolbars" class="cf">
        <nav id="toolbar_databrary" class="toolbar toolbar_databrary">
            <div class="wrap">
                <div class="row">
                    <div class="title cf col-desktop-10 col-laptop-7 col-tablet-4 col-mobile-2">
                        <h1 class="toolbar_h1">
                            <a href="@routes.Site.start" title="Databrary: An Open Data Library"><span>Databrary</span></a>
                        </h1>

                        <nav class="toolbar_nav cf hide-mobile hide-cell">
                            <ul class="toolbar_nav_ul inline-block flat cf">
                                <li><a href="@routes.VolumeHtml.search">explore</a></li>
                                <li><a href="http://databrary.org/user-guide.html">share</a></li>
                                <li><a href="https://github.com/databrary">discover</a></li>
                            </ul>
                        </nav>
                    </div>

                    <div class="toolbar_user col-desktop-5 col-laptop-5 col-tablet-5 col-mobile-4">
                @requestOption match {
                    case Some(request : SiteRequest.Auth[_]) => {
                        <a href="@requestOption.get.identity.pageURL" class="toolbar_user_link">
                            <span class="username">@requestOption.get.identity.name</span>
                            <img src="@display.avatar(requestOption.get.identity, 16)" alt="@requestOption.get.identity.name" class="avatar">
                        </a>

                        @if(request.access.isAdmin) {
                            <span class="sep">|</span>

                            @if(request.superuser) {
                                <a class="superuser on" href="@routes.LoginHtml.superuserOff">SU</a>
                            } else {
                                @defining(new LoginController.SuperuserForm()(request)) { form =>
                                    @widget.tag.form(form) {
                                        @defining(helper.FieldConstructor(widget.tag.rawFieldConstructor.f)) { implicit fieldConstructor =>
                                            @widget.tag.inputPassword(form.auth(), 'class -> "mini password")
                                            <button type="submit" class="link superuser off">SU</button>
                                        }
                                    }
                                }
                            }
                        }

                        <span class="sep">|</span>

                        <a href="@routes.LoginHtml.logout">logout</a>
                    }

                    case _ => {
                        <a href="@routes.LoginHtml.view">login</a>
                    }
                }
                    </div>
                </div>
            </div>
        </nav>
    </section>

    <main ng-view id="main" class="main">
        <noscript>
            @body
        </noscript>
    </main>

    <div id="messages" class="messages" ng-controller="MessageCtrl" ng-class="{messages_enabled: isEnabled()}">
        <div ng-repeat="message in messages | filter:{enabled: true}" id="{{message.id}}" class="message message_{{message.type}} message_animate" ng-class="{message_enabled: message.enabled, message_target: message.target, message_closable: message.closable}" style="z-index : { { 500 - $ index } } ;">
            <div class="wrap">
                <div class="row">
                    <div class="col-full">
                        <div class="message_close" ng-if="message.closeable" ng-click="disableMessage(message)"></div>
                        <div class="message_content" ng-bind-html="message.message"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer id="site-footer" class="site-footer">
        <div class="wrap">
            <div class="row">
                <div class="site-footer-links col-desktop-8 col-laptop-6 col-tablet-5 col-mobile-6 col-cell">
                    <p>Stay informed with <a href="/contact/newsletter.html">our newsletter</a>!</p>
                </div>

                <div class="site-footer-social col-desktop-8 col-laptop-6 col-tablet-4 col-mobile-6 col-cell">
                    <p>Find us on
                        <a href="https://www.facebook.com/pages/Databrary/185349568273416" target="_blank" class="img"><img id="facebook" src="/public/images/social/16px/facebook.png" alt="Facebook"></a>,
                        <a href="https://plus.google.com/u/1/111083162045777800330/posts" target="_blank" class="img"><img id="google-plus" src="/public/images/social/16px/google-plus.png" alt="Google+"></a>,
                        <a href="https://twitter.com/databrary" target="_blank" class="img"><img id="twitter" src="/public/images/social/16px/twitter.png" alt="Twitter"></a>, and
                        <a href="https://github.com/databrary/" target="_blank" class="img"><img id="github" src="/public/images/social/16px/github.png" alt="GitHub"></a>.
                    </p>
                </div>

                <div class="col-full site-footer-legal">
                    <p>This material is based upon work supported by the National Science Foundation under Grant No. BCS-1238599 and the Eunice Kennedy Shriver National Institute of Child Health and Human Development under Cooperative Agreement U01-HD-076595. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation or the Eunice Kennedy Shriver National Institute of Child Health and Human Development.</p>

                    <p>
                        <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Databrary.org documentation</span> is licensed under a
                        <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.en_US">Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License</a>.
                    </p>

                    <ul class="site-footer-grants">
                        <li>
                            <a href="http://www.nsf.gov/awardsearch/showAward?AWD_ID=1238599&HistoricalAwards=false">
                                <img src="/public/images/grants/nsf.png" class="nsf"> BCS-1238599 </a>
                        </li>

                        <li>
                            <a href="http://projectreporter.nih.gov/project_info_description.cfm?aid=8531595&icde=15908155&ddparam=&ddvalue=&ddsub=&cr=1&csb=default&cs=ASC">
                                <img src="/public/images/grants/nih.png" class="nih"> U01-HD-076595 </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>

