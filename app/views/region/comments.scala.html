@(post : Option[Call], comments : Seq[Comment])(implicit request : SiteRequest[_])

@import helper.FieldConstructor
    @implicitField = @{
        FieldConstructor(tag.minimalFieldConstructor.f)
    }

<section id="comments" class="col_8">
    <h1>Comments</h1>

    @post.map { post =>
        @if(request.access >= Permission.COMMENT) {
            <div class="comment form">
                <header class="userinfo cf">
                    <div class="avatar">
                        <a href="@request.user.get.pageURL" title="@request.user.get.name"><img src="@display.gravatarUrl(request.user.get.email, 44)" alt="@request.user.get.name"></a>
                    </div>

                    <div class="info">
                        <div class="name">
                            <a href="@request.user.get.pageURL" title="@request.user.get.name">@request.user.get.name</a>
                        </div>

                        <div class="date">
                            Comment now
                        </div>
                    </div>
                </header>

                @helper.form(post) {
                    <div class="body">
                        @helper.textarea(controllers.Comment.form("text"))
                        <button type="submit" class="button first">Post</button>
                    </div>
                }
            </div>

        }
    }

    @comments.map { c =>
        <article class="comment">
            <header class="userinfo cf">
                <div class="avatar">
                    <a href="@c.who.pageURL" title="@c.who.name"><img src="@display.gravatarUrl(c.who.email, 44)" alt="@c.who.name"></a>
                </div>

                <div class="info">
                    <div class="name">
                        <a href="@c.who.pageURL" title="@c.who.name">@c.who.name</a>
                    </div>

                    <div class="date">
                    @display(c.when)
                    </div>
                </div>
            </header>

            <div class="body">
            @display.plainText(c.text)
            </div>
        </article>
    }
    </section>
