@(study: Study, assetMap: (Map[String, Seq[AssetLink]], Map[String, Seq[AssetLink]]))(implicit request: SiteRequest[_])

@template.crud("Study: " + study.title) {
	<article id="study_@study.id.unId" class="study">
		@crud.studyHeader(study)

		<div class="row">
			<div class="description col_6">
			@study.description.map(display.plainText _)
			</div>

			<footer class="extended col_6">
				<div class="row">
					<div class="wide_col_6">
						<aside class="thumb col_6">
						@widget.studyThumb(study)
						</aside>

						<aside class="dates foot col_6">
						@study.creationAudit(request.db).map { creation =>
							<span class="date created">
								Created <time datetime="@creation.when" pubdate>@display.date(creation.when, "MMMM yyyy")</time></span>
						}
						</aside>

						<aside class="citing foot col_6">
							<h2>Citation</h2>

							@widget.studyCitation(study)
						</aside>
					</div>

					<div class="wide_col_3">
						<aside class="investigators foot col_3">
							<h2>Investigators</h2>

							@study.partyAccess(Permission.CONTRIBUTE)(request.db).map { a =>
								@widget.userinfo(a.party)
							}
						</aside>

						<div class="col_3">
							<aside class="funding foot">
								<h2>Funding</h2>

								@widget.userinfo(models.Party.Root)
							</aside>

							<aside class="access cf foot">
								<h2>Sharing</h2>
								@widget.studyAccess(study)
							</aside>
						</div>
					</div>
				</div>
			</footer>
		</div>

		<section id="metadata" class="tabset">
			<div id="media" class="view">
                <div id="highlights" class="view">
                    <h2 class='tab' data-tip="All media in the Highlights tab is available for public use and sharing.">Highlights</h2>

                    @widget.thumbList(study, assetMap._1.getOrElse("video", Nil))
                    @widget.thumbList(study, assetMap._1.getOrElse("image", Nil))
                    @widget.thumbList(study, assetMap._1.getOrElse("audio", Nil))
                </div>

                <h2 class='tab' data-tip="The Media tab lists top-level video, audio, and images asscoiated with the current study.">Media</h2>

				@widget.thumbList(study, assetMap._2.getOrElse("video", Nil))
				@widget.thumbList(study, assetMap._2.getOrElse("image", Nil))
				@widget.thumbList(study, assetMap._2.getOrElse("audio", Nil))
			</div>

			<div id="documents" class="view">
				<h2 class='tab' data-tip="The Documents tab lists non-media files associated with the current study.">Documents</h2>
				@widget.assetList(study)
			</div>

			<div id="participants" class="view">
				<h2 class='tab' data-tip="The Participants tab lists basic information regarding the participants of the current study.">Participants</h2>
				@widget.slotList(study)
			</div>

			<div id="permission" class="view">
				<h2 class='tab' data-tip="The Permissions tab lists who has access to the current study, and what that access allows.">Permission</h2>

				@widget.studyPermission(study)
			</div>
		</section>

		<div class="row">
		@region.comments(Some(routes.Comment.postStudy(study.id)), study.comments(true)(request.db))
		</div>
	</article>
}
