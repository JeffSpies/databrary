<section id="toolbar" class="toolbar cf">
  <div class="wrap">
    <div class="row">
      <div class="title cf col-desktop-7 col-tablet-7" ng-class="{'col-mobile-4': page.models.Login.isLoggedIn(), 'col-mobile-2': !page.models.Login.isLoggedIn()}">
        <h1 class="toolbar-site" ng-show="page.$route.current.controller!=='site/home'">
          <a ng-href="{{::page.router.index()}}" title="Databrary: An Open Data Library"></a>
        </h1>

        <nav class="toolbar-nav cf">
          <ul class="toolbar-nav-ul inline-block flat cf">
            <li class="hide-tablet hide-desktop">
              <a href="" class="toolbar-nav-toggle" ng-click="hoverNavToggle($event)">
                <img src="/public/images/icon/navmenu.svg" class="icon">
              </a>
            </li>
            <li class="hide-mobile">
              <a href="/search"><span>Datasets</span></a>                       
            </li>
            <li class="hide-mobile">
              <a href="http://databrary.org/access/guide.html"><span>User Guide</span></a>
            </li>
            <li class="hide-mobile">
              <a href="http://databrary.org/community.html"><span>Community</span></a>
            </li>
            <li ng-repeat="link in page.display.toolbarLinks">
              <a ng-href="{{::link.url}}" class="button mini" ng-class="::link.type" target="{{::link.target}}" ng-click="link.click()">
                <span ng-if="::link.icon" class="icon" ng-class="::link.icon"></span>
                <span class="text" ng-bind="::link.html"></span>
              </a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="toolbar-user" ng-class="{'col-mobile-2': page.models.Login.isLoggedIn(), 'col-mobile-4': !page.models.Login.isLoggedIn()}">

        <span ng-if="!page.models.Login.isLoggedIn()">
          <a ng-href="{{::page.router.login()}}" message="toolbar.login"></a>

          <span class="sep">|</span>

          <a ng-href="{{::page.router.register()}}" message="toolbar.register"></a>
        </span>

        <span ng-if="page.models.Login.isLoggedIn()">
          <a href="" class="toolbar-user-link" ng-class="{'toolbar-superuser': page.models.Login.user.superuser !== undefined, on: !!page.models.Login.user.superuser}" ng-click="hoverUserToggle($event)">
            <img ng-src="{{::page.models.Login.user.avatarRoute()}}" class="toolbar-avatar"> 
            <span class="username hide-mobile hide-tablet" ng-bind="::page.models.Login.user.name"></span>
          </a>
        </span>

        <a href="" ng-click="hoverSearchToggle($event)" class="toolbar-search-toggle">
          <img src="/public/images/icon/search.svg" class="icon">
          <span class="hide-mobile hide-tablet">Search</span>
        </a>

        <span class="sep">|</span>

        <a href="mailto:feedback@databrary.org" class="icon contact" id="toolbar-contact" target="_blank" tooltip="'toolbar.contact' | message"></a>

      </div>

      <section class="toolbar-hover user" ng-if="page.models.Login.isLoggedIn() && hoverUser" click-elsewhere="hoverUserToggle()">
        <div class="row">
          <div class="toolbar-user-menu">
            <ul class="flat">
              <li><strong ng-bind="::page.models.Login.user.name"></strong></li>
              <li ng-if="::!page.models.Login.isAuthorized()">
                <a ng-href="{{::page.router.register()}}" class="toolbar-user-link" message="toolbar.reregister"></a>
              </li>
              <li>
                <a ng-href="{{::page.router.profile()}}" class="toolbar-user-link" message="toolbar.profile"></a>
              </li>
              <li>
                <a ng-href="{{::page.router.volumeCreate()}}" message="volume.edit.create" ng-if="::page.models.Login.isAuthorized()"></a>
              </li>
              <li><a href="" ng-click="page.auth.logout()" message="toolbar.logout"></a>
              </li>

              <li ng-if="::page.models.Login.user.superuser !== undefined" class="toolbar-password-form">
                <ng-form name="superuserForm" ng-if="::!page.models.Login.user.superuser" class="cf">
                  <input type="password" class="mini password" ng-model="superuserForm.auth" placeholder="Password" key-enter="page.auth.toggleSU(superuserForm)">
                  <button type="submit" class="link toolbar-superuser off" ng-click="page.auth.toggleSU(superuserForm)">
                    activate SU
                  </button>
                </ng-form>

                <a ng-if="::page.models.Login.user.superuser" class="toolbar-superuser on" href="#" ng-click="page.auth.toggleSU()">deactivate SU</a>
              </li>
            </ul>
          </div>

          <div class="user-icon">
            <img ng-src="{{::page.models.Login.user.avatarRoute(96)}}" class="toolbar-hover-avatar">
          </div>
        </div>
      </section>

      <section class="toolbar-hover search" click-elsewhere="hoverSearchToggle()" ng-if="hoverSearch">
        <div class="toolbar-search">
          <ng-form class="search-form">
            <div class="search-form-search">
              <input type="search" ng-model="search.data.query" placeholder="{{::'search.prompt' | message}}" key-enter="search()"/>
            </div>
          </ng-form>
        </div>  
      </section>

      <section class="toolbar-hidden-navs" click-elsewhere="hoverNavToggle()" ng-if="hoverNav">
        <div class="wrap">
          <div class="row">
            <nav class="toolbar-nav cf">
              <ul class="toolbar-nav-ul inline-block flat cf">
                <li>
                  <a href="" class="toolbar-nav-toggle" ng-click="hoverNavToggle($event)">
                    <img src="/public/images/icon/backarrow.svg" class="icon">
                  </a>
                </li>
                <li>
                  <a href="/search"><span>Datasets</span></a>                       
                </li>
                <li>
                  <a href="http://databrary.org/access/guide.html"><span>User Guide</span></a>
                </li>
                <li>
                  <a href="http://databrary.org/community.html"><span>Community</span></a>
                </li>
              </ul>
            </nav>     
          </div>
        </div>      
      </section>      

    </div>
  </div>
</section>
