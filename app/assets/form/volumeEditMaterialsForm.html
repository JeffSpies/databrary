<form name="volumeEditMaterialsForm" bindonce novalidate flow-init="page.models.asset.flowOptions" flow-file-added="volumeEditMaterialsForm.addedCall($file,$event)" flow-file-success="volumeEditMaterialsForm.assetCall($file)" flow-file-progress="volumeEditMaterialsForm.perFileProgress($file)" flow-progress="totalProgress()">
  <messages form="volumeEditMaterialsForm"></messages>

  <upload-progress progress-value="volumeEditMaterialsForm.totalProgress"></upload-progress>

  <fieldset ng-repeat="asset in volumeEditMaterialsForm.filtered" ng-form="volumeEditMaterialsForm.asset-{{$index}}" flow-drag-enter="dropClasses['over-form'] = true" flow-drag-leave="dropClasses['over-form'] = false" ng-init="dropClasses={'drop-zone': true, 'over-form': false, 'over-zone': false};" novalidate expose>
	  <messages ng-init="form = volumeEditMaterialsForm['asset-'+$index]; form.subform = this; volumeEditMaterialsForm.store(this);"></messages>

    <validator form="form" name="file" label="'material.file' | message">
      <div ng-if="!asset.asset.creation" flow-drop flow-btn flow-drag-enter="dropClasses['over-zone'] = true" flow-drag-leave="dropClasses['over-zone'] = false" ng-class="dropClasses">
	      <span ng-if="!asset.file">Drop here or click to browse.</span>
	      <span ng-if="asset.file" ng-bind="asset.file.name"</span>
      </div>

      <div ng-if="asset.asset.creation">
        <input type="text" name="filename" bo-value="asset.asset.creation.name + ', ' + page.$filter('date')(asset.asset.creation.date, 'medium')" ng-model="asset.file" disabled>
        <button ng-click="volumeEditMaterialsForm.replace(this)" bo-html="'replace' | message" class="blue mini pull"></button>
      </div>
    <upload-progress progress-value="fileUploadProgress"></upload-progress>
    </validator>

    <validator form="form" name="classification" label="'material.classification' | message">
      <select name="classification" ng-model="asset.classification" ng-options="c as 'classification.'+c | message for c in ['SHARED','PUBLIC']" ng-required></select>
    </validator>

    <validator form="form" name="name" label="'material.name' | message">
      <input type="text" name="name" ng-model="asset.name" placeholder="{{'material.name.placeholder' | message}}">
    </validator>

    <button ng-click="volumeEditMaterialsForm.save(this)" ng-bind="'save' | message" class="green" ng-disabled="volumeEditMaterialsForm.disableButton(this)"></button>
    <button ng-click="volumeEditMaterialsForm.reset(this)" bo-html="'revert' | message" class="yellow" ng-disabled="volumeEditMaterialsForm.disableButton(this)"></button>
    <button ng-click="volumeEditMaterialsForm.remove(this)" bo-html="'remove' | message" class="red"></button>
  </fieldset>

  <fieldset class="clean">
    <button ng-click="volumeEditMaterialsForm.saveAll()" ng-bind="'save.all' | message" class="green" ng-disabled="!volumeEditMaterialsForm.$dirty"></button>
    <button ng-click="volumeEditMaterialsForm.resetAll()" bo-html="'revert.all' | message" class="yellow" ng-disabled="!volumeEditMaterialsForm.$dirty"></button>
    <button ng-click="volumeEditMaterialsForm.add()" bo-html="'add' | message" class="orange"></button>
  </fieldset>
</form>
