<div id="spreadsheet">
  <table id="spreadsheet-table">
    <colgroup>
      <col/>
      <col/>
      <col/>
    </colgroup>
    <colgroup ng-repeat="record in recordCols track by record.category.id">
      <col ng-repeat="metric in record.metrics"/>
    </colgroup>
    <thead>
      <tr id="spreadsheet-head-groups">
	<th colspan="3">session</th>
	<th ng-repeat="record in recordCols track by record.category.id" colspan="{{record.metrics.length}}" ng-bind="record.category.name" ng-click="clickCategory(record, $event)"></th>
      </tr>
      <tr id="spreadsheet-head-metrics">
	<th class="first" ng-click="clickSlot('name')"/>
	<th><a href="" ng-click="clickSlot('date')">date</a></th>
	<th class="last"><a href="" ng-click="clickSlot('consent')">consent</a></th>

	<th ng-repeat="col in metricCols track by $index" ng-class="{'first': col.first, 'last': col.last}">
	  <a href="" ng-click="clickMetric(col)" ng-bind="col.metric.name"></a>
	</th>
      </tr>
    </thead>
    <tbody id="ss-top" ng-click="click($event)">
    </tbody>
    <tbody id="ss" ng-click="click($event)">
    </tbody>
  </table>
</div>
