<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Databrary/View/Notification.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE OverloadedStrings, RecordWildCards #-}</span>
<a name="line-2"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>Notification</span>
<a name="line-3"></a>  <span class='hs-layout'>(</span> <span class='hs-varid'>mailNotifications</span>
<a name="line-4"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>htmlNotification</span>
<a name="line-5"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-6"></a>
<a name="line-7"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Arrow</span> <span class='hs-layout'>(</span><span class='hs-varid'>second</span><span class='hs-layout'>)</span>
<a name="line-8"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-varop'>.</span><span class='hs-conid'>Builder</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BSB</span>
<a name="line-9"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-varop'>.</span><span class='hs-conid'>Char8</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>BSC</span>
<a name="line-10"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Function</span> <span class='hs-layout'>(</span><span class='hs-varid'>on</span><span class='hs-layout'>)</span>
<a name="line-11"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span><span class='hs-layout'>,</span> <span class='hs-varid'>isJust</span><span class='hs-layout'>)</span>
<a name="line-12"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Monoid</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-13"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TE</span>
<a name="line-14"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Lazy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TL</span>
<a name="line-15"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Lazy</span><span class='hs-varop'>.</span><span class='hs-conid'>Encoding</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>TLE</span>
<a name="line-16"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Blaze</span><span class='hs-varop'>.</span><span class='hs-conid'>Html5</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>H</span>
<a name="line-17"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Text</span><span class='hs-varop'>.</span><span class='hs-conid'>Blaze</span><span class='hs-varop'>.</span><span class='hs-conid'>Html5</span><span class='hs-varop'>.</span><span class='hs-conid'>Attributes</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>HA</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Ops</span>
<a name="line-20"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Permission</span>
<a name="line-21"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Id</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<a name="line-22"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Party</span>
<a name="line-23"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Volume</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Segment</span>
<a name="line-25"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Slot</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Tag</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<a name="line-27"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Model</span><span class='hs-varop'>.</span><span class='hs-conid'>Notification</span>
<a name="line-28"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Service</span><span class='hs-varop'>.</span><span class='hs-conid'>Messages</span>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>HTTP</span><span class='hs-varop'>.</span><span class='hs-conid'>Route</span>
<a name="line-30"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Action</span><span class='hs-varop'>.</span><span class='hs-conid'>Route</span>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Controller</span><span class='hs-varop'>.</span><span class='hs-conid'>Paths</span>
<a name="line-32"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Controller</span><span class='hs-varop'>.</span><span class='hs-conid'>Party</span>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Controller</span><span class='hs-varop'>.</span><span class='hs-conid'>Volume</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Controller</span><span class='hs-varop'>.</span><span class='hs-conid'>Slot</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>Controller</span><span class='hs-varop'>.</span><span class='hs-conid'>AssetSegment</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>Authorize</span> <span class='hs-layout'>(</span><span class='hs-varid'>authorizeSiteTitle</span><span class='hs-layout'>)</span>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>Party</span> <span class='hs-layout'>(</span><span class='hs-varid'>htmlPartyViewLink</span><span class='hs-layout'>)</span>
<a name="line-38"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>Volume</span> <span class='hs-layout'>(</span><span class='hs-varid'>htmlVolumeViewLink</span><span class='hs-layout'>)</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>VolumeAccess</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessTitle</span><span class='hs-layout'>,</span> <span class='hs-varid'>volumeAccessPresetTitle</span><span class='hs-layout'>)</span>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>Container</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span><span class='hs-layout'>)</span>
<a name="line-41"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Databrary</span><span class='hs-varop'>.</span><span class='hs-conid'>View</span><span class='hs-varop'>.</span><span class='hs-conid'>Html</span>
<a name="line-42"></a>
<a name="line-43"></a><a name="mailLink"></a><span class='hs-definition'>mailLink</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Route</span> <span class='hs-varid'>r</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span> <span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span>
<a name="line-44"></a><span class='hs-definition'>mailLink</span> <span class='hs-varid'>u</span> <span class='hs-varid'>a</span> <span class='hs-varid'>q</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TLE</span><span class='hs-varop'>.</span><span class='hs-varid'>decodeLatin1</span> <span class='hs-varop'>$</span> <span class='hs-conid'>BSB</span><span class='hs-varop'>.</span><span class='hs-varid'>toLazyByteString</span> <span class='hs-varop'>$</span> <span class='hs-str'>"https://databrary.org"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>actionURL</span> <span class='hs-conid'>Nothing</span> <span class='hs-varid'>u</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>second</span> <span class='hs-conid'>Just</span><span class='hs-layout'>)</span> <span class='hs-varid'>q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span><span class='hs-layout'>)</span>
<a name="line-45"></a>
<a name="line-46"></a><a name="partyEditLink"></a><span class='hs-definition'>partyEditLink</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>ActionRoute</span> <span class='hs-conid'>PartyTarget</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PartyTarget</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PartyRow</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PartyRow</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>t</span>
<a name="line-47"></a><span class='hs-definition'>partyEditLink</span> <span class='hs-varid'>link</span> <span class='hs-varid'>target</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>link</span> <span class='hs-varid'>viewPartyEdit</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>on</span> <span class='hs-layout'>(</span><span class='hs-varop'>==</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyId</span> <span class='hs-varid'>p</span> <span class='hs-varid'>target</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>TargetProfile</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>TargetParty</span> <span class='hs-layout'>(</span><span class='hs-varid'>partyId</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-48"></a>
<a name="line-49"></a><a name="mailNotification"></a><span class='hs-definition'>mailNotification</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Messages</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Notification</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span>
<a name="line-50"></a><span class='hs-definition'>mailNotification</span> <span class='hs-varid'>msg</span> <span class='hs-conid'>Notification</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>notificationNotice</span> <span class='hs-keyword'>of</span>
<a name="line-51"></a>  <span class='hs-conid'>NoticeAccountChange</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-52"></a>    <span class='hs-varid'>party'S</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" email or password has been changed. If you made this change, you may ignore this email. To review or update your account information, go to: "</span>
<a name="line-53"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>target</span> <span class='hs-varid'>notificationParty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"account"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-54"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"\nIf you did not make this change, please contact us immediately."</span>
<a name="line-55"></a>  <span class='hs-conid'>NoticeAuthorizeRequest</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-56"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" requested authorization from "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review the status of this request, go to: "</span>
<a name="line-57"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"apply"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span>
<a name="line-58"></a>  <span class='hs-conid'>NoticeAuthorizeGranted</span>
<a name="line-59"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>notificationPermission</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-60"></a>      <span class='hs-str'>"You have been authorized under "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>", "</span>
<a name="line-61"></a>      <span class='hs-varop'>&lt;&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>p</span> <span class='hs-varop'>==</span> <span class='hs-conid'>PermissionNONE</span> <span class='hs-keyword'>then</span> <span class='hs-str'>"for group/lab-only access."</span>
<a name="line-62"></a>         <span class='hs-keyword'>else</span> <span class='hs-str'>"as a Databrary "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>authorizeSiteTitle</span> <span class='hs-varid'>p</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". \
<a name="line-63"></a>      \Your authorization allows you to access all the shared data in Databrary. \
<a name="line-64"></a>      \Our primary goal is to inspire you to reuse shared videos on Databrary to ask new questions outside the scope of the original study. \
<a name="line-65"></a>      \You will also find illustrative video excerpts that you can use for teaching and to learn about other researchers' methods and procedures.\
<a name="line-66"></a>      \\n\n\
<a name="line-67"></a>      \Databrary's unique \"active curation\" functionality allows you to upload your videos as you collect them so that your data are backed up and preserved in our free, secure library, your videos are immediately available to you and your collaborators offsite, and your data are organized and ready for sharing. \
<a name="line-68"></a>      \Your data will remain private and accessible only to your lab members and collaborators until you are ready to share with the Databrary community. \
<a name="line-69"></a>      \When you are ready, sharing is as easy as clicking a button!\
<a name="line-70"></a>      \\n\n\
<a name="line-71"></a>      \You can use our template Databrary release form to obtain permission for sharing the data you collect from your participants, which can be found here: http://databrary.org/access/policies/release-template.html.\n\
<a name="line-72"></a>      \The release form can be added to new or existing IRB protocols. \
<a name="line-73"></a>      \It is completely adaptable and can be customized to suit your needs. \
<a name="line-74"></a>      \We also offer additional information and helpful tips about managing and sharing your video data in our User Guide: http://databrary.org/access/guide. \
<a name="line-75"></a>      \Information about downloading data from Databrary and other useful instructions can be found in the Frequently Asked Questions: https://www.databrary.org/resources/faq.html.\n\
<a name="line-76"></a>      \As soon as your protocol is amended to allow you to share data, you can start uploading your data from each new session. \
<a name="line-77"></a>      \Don't wait until your study is complete to upload your videos. \
<a name="line-78"></a>      \It's much easier to upload data after each data collection while your study is in progress!\
<a name="line-79"></a>      \\n\n\
<a name="line-80"></a>      \We are dedicated to providing assistance to the Databrary community. \
<a name="line-81"></a>      \Please contact us at support@databrary.org with questions or for help getting started.\
<a name="line-82"></a>      \\n"</span>
<a name="line-83"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-84"></a>      <span class='hs-str'>"Your authorization under "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" has been revoked. To review and apply for authorizations, go to: "</span>
<a name="line-85"></a>      <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"apply"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-86"></a>  <span class='hs-conid'>NoticeAuthorizeExpiring</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-87"></a>    <span class='hs-str'>"Your authorization under "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" will expire within a week. Please contact them and request that they renew your authorization."</span>
<a name="line-88"></a>  <span class='hs-conid'>NoticeAuthorizeExpired</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-89"></a>    <span class='hs-str'>"Your authorization under "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" has expired. Please contact them and request that they renew your authorization."</span>
<a name="line-90"></a>  <span class='hs-conid'>NoticeAuthorizeChildRequest</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-91"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" has requested to be authorized through "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To approve or reject this authorization request, go to: "</span>
<a name="line-92"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>target</span> <span class='hs-varid'>notificationParty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>personq</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>notificationAgent</span><span class='hs-keyglyph'>]</span>
<a name="line-93"></a>  <span class='hs-conid'>NoticeAuthorizeChildGranted</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-94"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>granted</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" authorization to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this authorization, go to: "</span>
<a name="line-95"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span>
<a name="line-96"></a>  <span class='hs-conid'>NoticeAuthorizeChildExpiring</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-97"></a>    <span class='hs-varid'>party'S</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" authorization will expire within a week. If you would like to renew their authorization, go to: "</span>
<a name="line-98"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span>
<a name="line-99"></a>  <span class='hs-conid'>NoticeAuthorizeChildExpired</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-100"></a>    <span class='hs-varid'>party'S</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" authorization has expired. If you would like to renew their authorization, go to: "</span>
<a name="line-101"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span>
<a name="line-102"></a>  <span class='hs-conid'>NoticeVolumeAssist</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-103"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" requested assistance with your volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this request, go to: "</span>
<a name="line-104"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"assist"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-105"></a>  <span class='hs-conid'>NoticeVolumeCreated</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-106"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" created a volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>", on "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" behalf. To review this volume, go to: "</span>
<a name="line-107"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>mailLink</span> <span class='hs-varid'>viewVolume</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>volumeId</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span>
<a name="line-108"></a>  <span class='hs-conid'>NoticeVolumeSharing</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-109"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" changed your volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>", to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessPresetTitle</span> <span class='hs-layout'>(</span><span class='hs-conid'>PermissionNONE</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>perm</span><span class='hs-layout'>)</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this change, go to: "</span>
<a name="line-110"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"access"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-111"></a>  <span class='hs-conid'>NoticeVolumeAccessOther</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-112"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" set "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" access to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessTitle</span> <span class='hs-varid'>perm</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" on your volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this change, go to: "</span>
<a name="line-113"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"access"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span>
<a name="line-114"></a>  <span class='hs-conid'>NoticeVolumeAccess</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-115"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" set "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" access to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessTitle</span> <span class='hs-varid'>perm</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" on your volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this change, go to: "</span>
<a name="line-116"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"access"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-117"></a>  <span class='hs-conid'>NoticeReleaseSlot</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-118"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" set the release level of a folder in "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span> <span class='hs-varid'>notificationRelease</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this change, go to: "</span>
<a name="line-119"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>mailLink</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewSlot</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span>
<a name="line-120"></a>  <span class='hs-conid'>NoticeReleaseAsset</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-121"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" set the release level of a file in your volume ("</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>") to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span> <span class='hs-varid'>notificationRelease</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this change, go to: "</span>
<a name="line-122"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>mailLink</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewSlot</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"asset"</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationAssetId</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-123"></a>  <span class='hs-conid'>NoticeReleaseExcerpt</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-124"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" set the release level of a highlight in your volume ("</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>") to "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span> <span class='hs-varid'>notificationRelease</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review this change, go to: "</span>
<a name="line-125"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>assetSegment</span>
<a name="line-126"></a>  <span class='hs-conid'>NoticeExcerptVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-127"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" created a highlight in your volume ("</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"). To review this highlight, go to: "</span>
<a name="line-128"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>assetSegment</span>
<a name="line-129"></a>  <span class='hs-conid'>NoticeCommentVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-130"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" commented on your volume ("</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"). To review or reply, go to: "</span>
<a name="line-131"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>slotVolume</span> <span class='hs-conid'>[]</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"#comment-"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationCommentId</span>
<a name="line-132"></a>  <span class='hs-conid'>NoticeCommentReply</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-comment'>-- high risk information disclosure of volume name</span>
<a name="line-133"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" replied to your comment on the volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>". To review or reply, go to: "</span>
<a name="line-134"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>slotVolume</span> <span class='hs-conid'>[]</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"#comment-"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationCommentId</span>
<a name="line-135"></a>  <span class='hs-conid'>NoticeTagVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-136"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" tagged the volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>", with \""</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-varop'>.</span> <span class='hs-conid'>TE</span><span class='hs-varop'>.</span><span class='hs-varid'>decodeLatin1</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tagNameBS</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tagName</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationTag</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"\". To review tags, go to: "</span>
<a name="line-137"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>slotVolume</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"tag"</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-varid'>tagNameBS</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tagName</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationTag</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"#panel-tags"</span>
<a name="line-138"></a>  <span class='hs-conid'>NoticeSharedVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-139"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>" shared the following volume, "</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>", on Databrary. To review, go to: "</span>
<a name="line-140"></a>    <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>mailLink</span> <span class='hs-varid'>viewVolume</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>volumeId</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span>
<a name="line-141"></a>  <span class='hs-conid'>NoticeNewsletter</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-142"></a>    <span class='hs-str'>"A new Databrary newsletter has been posted. Te see it, go to: http://databrary.org/news.html"</span>
<a name="line-143"></a>  <span class='hs-keyword'>where</span>
<a name="line-144"></a>  <span class='hs-varid'>target</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partyRow</span> <span class='hs-layout'>(</span><span class='hs-varid'>accountParty</span> <span class='hs-varid'>notificationTarget</span><span class='hs-layout'>)</span>
<a name="line-145"></a>  <span class='hs-varid'>person</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>on</span> <span class='hs-layout'>(</span><span class='hs-varop'>/=</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyId</span> <span class='hs-varid'>p</span> <span class='hs-varid'>target</span><span class='hs-layout'>)</span> <span class='hs-varop'>`thenUse`</span> <span class='hs-layout'>(</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-layout'>(</span><span class='hs-varid'>partyName</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-146"></a>  <span class='hs-varid'>agent</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-str'>"You"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>person</span> <span class='hs-varid'>notificationAgent</span>
<a name="line-147"></a>  <span class='hs-varid'>partyp</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>person</span> <span class='hs-varop'>=&lt;&lt;</span> <span class='hs-varid'>notificationParty</span>
<a name="line-148"></a>  <span class='hs-varid'>party</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-str'>"you"</span> <span class='hs-varid'>partyp</span>
<a name="line-149"></a>  <span class='hs-varid'>party'sOr</span> <span class='hs-varid'>your</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>your</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"'s"</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyp</span>
<a name="line-150"></a>  <span class='hs-varid'>party's</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>party'sOr</span> <span class='hs-str'>"your"</span>
<a name="line-151"></a>  <span class='hs-varid'>party'S</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>party'sOr</span> <span class='hs-str'>"Your"</span>
<a name="line-152"></a>  <span class='hs-varid'>personq</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"party"</span><span class='hs-layout'>,</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>""</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>partyId</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-153"></a>  <span class='hs-varid'>partyq</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>personq</span> <span class='hs-varid'>notificationParty</span>
<a name="line-154"></a>  <span class='hs-varid'>partyEdit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partyEditLink</span> <span class='hs-varid'>mailLink</span> <span class='hs-varid'>target</span>
<a name="line-155"></a>  <span class='hs-varid'>granted</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>"revoked"</span> <span class='hs-layout'>(</span><span class='hs-varid'>const</span> <span class='hs-str'>"granted"</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationPermission</span>
<a name="line-156"></a>  <span class='hs-varid'>volume</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>"&lt;VOLUME&gt;"</span> <span class='hs-layout'>(</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromStrict</span> <span class='hs-varop'>.</span> <span class='hs-varid'>volumeName</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationVolume</span>
<a name="line-157"></a>  <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mailLink</span> <span class='hs-varid'>viewVolumeEdit</span> <span class='hs-layout'>(</span><span class='hs-varid'>maybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>volumeId</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>)</span>
<a name="line-158"></a>  <span class='hs-varid'>perm</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-conid'>PermissionNONE</span> <span class='hs-varid'>notificationPermission</span>
<a name="line-159"></a>  <span class='hs-varid'>slot</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Id</span> <span class='hs-varop'>$</span> <span class='hs-conid'>SlotId</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>notificationContainerId</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>fullSegment</span> <span class='hs-varid'>notificationSegment</span><span class='hs-layout'>)</span>
<a name="line-160"></a>  <span class='hs-varid'>assetSegment</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mailLink</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewAssetSegment</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>notificationAssetId</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span>
<a name="line-161"></a>  <span class='hs-varid'>slotVolume</span>
<a name="line-162"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isJust</span> <span class='hs-varid'>notificationContainerId</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mailLink</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewSlot</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-163"></a>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mailLink</span> <span class='hs-varid'>viewVolume</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>volumeId</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>)</span>
<a name="line-164"></a>
<a name="line-165"></a><a name="mailNotifications"></a><span class='hs-definition'>mailNotifications</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Messages</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Notification</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span>
<a name="line-166"></a><span class='hs-definition'>mailNotifications</span> <span class='hs-varid'>msg</span> <span class='hs-keyglyph'>~</span><span class='hs-varid'>l</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>Notification</span><span class='hs-layout'>{</span> <span class='hs-varid'>notificationTarget</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>u</span> <span class='hs-layout'>}</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-167"></a>  <span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>fromChunks</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"Dear "</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyName</span> <span class='hs-varid'>target</span><span class='hs-layout'>,</span> <span class='hs-str'>",\n"</span><span class='hs-keyglyph'>]</span>
<a name="line-168"></a>  <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-chr'>'\n'</span> <span class='hs-varop'>`</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>cons</span><span class='hs-varop'>`</span> <span class='hs-varid'>mailNotification</span> <span class='hs-varid'>msg</span> <span class='hs-varid'>n</span> <span class='hs-varop'>`</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>snoc</span><span class='hs-varop'>`</span> <span class='hs-chr'>'\n'</span><span class='hs-layout'>)</span> <span class='hs-varid'>l</span>
<a name="line-169"></a>  <span class='hs-varop'>&lt;&gt;</span> <span class='hs-str'>"\nYou can change your notification settings or unsubscribe here: "</span>
<a name="line-170"></a>  <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>partyEditLink</span> <span class='hs-varid'>mailLink</span> <span class='hs-varid'>target</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"notifications"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-varop'>`</span><span class='hs-conid'>TL</span><span class='hs-varop'>.</span><span class='hs-varid'>snoc</span><span class='hs-varop'>`</span> <span class='hs-chr'>'\n'</span>
<a name="line-171"></a>  <span class='hs-keyword'>where</span>
<a name="line-172"></a>  <span class='hs-varid'>target</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partyRow</span> <span class='hs-layout'>(</span><span class='hs-varid'>accountParty</span> <span class='hs-varid'>u</span><span class='hs-layout'>)</span>
<a name="line-173"></a>
<a name="line-174"></a><a name="htmlNotification"></a><span class='hs-definition'>htmlNotification</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Messages</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Notification</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-conid'>Html</span>
<a name="line-175"></a><span class='hs-definition'>htmlNotification</span> <span class='hs-varid'>msg</span> <span class='hs-conid'>Notification</span><span class='hs-layout'>{</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>notificationNotice</span> <span class='hs-keyword'>of</span>
<a name="line-176"></a>  <span class='hs-conid'>NoticeAccountChange</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-177"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" changed "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span>
<a name="line-178"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>target</span> <span class='hs-varid'>notificationParty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"account"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"account information"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-179"></a>  <span class='hs-conid'>NoticeAuthorizeRequest</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-180"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" requested "</span>
<a name="line-181"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"apply"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" from "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-182"></a>  <span class='hs-conid'>NoticeAuthorizeGranted</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-183"></a>    <span class='hs-str'>"Your "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"apply"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span>
<a name="line-184"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" under "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-str'>"yourself"</span> <span class='hs-layout'>(</span><span class='hs-varid'>person</span> <span class='hs-varop'>=&lt;&lt;</span> <span class='hs-varid'>notificationParty</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" has been "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>granted</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-185"></a>  <span class='hs-conid'>NoticeAuthorizeExpiring</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-186"></a>    <span class='hs-str'>"Your "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"apply"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" through "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" will expire soon."</span>
<a name="line-187"></a>  <span class='hs-conid'>NoticeAuthorizeExpired</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-188"></a>    <span class='hs-str'>"Your "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"apply"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" through "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" is expired."</span>
<a name="line-189"></a>  <span class='hs-conid'>NoticeAuthorizeChildRequest</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-190"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" requested "</span>
<a name="line-191"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>target</span> <span class='hs-varid'>notificationParty</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>personq</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>notificationAgent</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" from "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-192"></a>  <span class='hs-conid'>NoticeAuthorizeChildGranted</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-193"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>granted</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span>
<a name="line-194"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-195"></a>  <span class='hs-conid'>NoticeAuthorizeChildExpiring</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-196"></a>    <span class='hs-varid'>party'S</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" will expire soon."</span>
<a name="line-197"></a>  <span class='hs-conid'>NoticeAuthorizeChildExpired</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-198"></a>    <span class='hs-varid'>party'S</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>partyEdit</span> <span class='hs-varid'>target</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"grant"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"authorization"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" is expired."</span>
<a name="line-199"></a>  <span class='hs-conid'>NoticeVolumeAssist</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-200"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" requested "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"assist"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"assistance"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" with "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-201"></a>  <span class='hs-conid'>NoticeVolumeCreated</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-202"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" created "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" on "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" behalf."</span>
<a name="line-203"></a>  <span class='hs-conid'>NoticeVolumeSharing</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-204"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" changed "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span>
<a name="line-205"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessPresetTitle</span> <span class='hs-layout'>(</span><span class='hs-conid'>PermissionNONE</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>perm</span><span class='hs-layout'>)</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-206"></a>  <span class='hs-conid'>NoticeVolumeAccessOther</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-207"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" set "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span>
<a name="line-208"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"access"</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>partyq</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"access"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessTitle</span> <span class='hs-varid'>perm</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" on "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-209"></a>  <span class='hs-conid'>NoticeVolumeAccess</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-210"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" set "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>party's</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span>
<a name="line-211"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"page"</span><span class='hs-layout'>,</span> <span class='hs-str'>"access"</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"access"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeAccessTitle</span> <span class='hs-varid'>perm</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" on "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-212"></a>  <span class='hs-conid'>NoticeReleaseSlot</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-213"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" set a "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>link</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewSlot</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-str'>"folder"</span>
<a name="line-214"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" in "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span> <span class='hs-varid'>notificationRelease</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-215"></a>  <span class='hs-conid'>NoticeReleaseAsset</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-216"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" set a "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>link</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewSlot</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"asset"</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationAssetId</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"file"</span>
<a name="line-217"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" in "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span> <span class='hs-varid'>notificationRelease</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-218"></a>  <span class='hs-conid'>NoticeReleaseExcerpt</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-219"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" set a "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>assetSegment</span> <span class='hs-str'>"highlight"</span>
<a name="line-220"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" in "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>text</span> <span class='hs-layout'>(</span><span class='hs-varid'>releaseTitle</span> <span class='hs-varid'>notificationRelease</span> <span class='hs-varid'>msg</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-221"></a>  <span class='hs-conid'>NoticeExcerptVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-222"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" created a "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>assetSegment</span> <span class='hs-str'>"highlight"</span>
<a name="line-223"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" in "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-224"></a>  <span class='hs-conid'>NoticeCommentVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-225"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>slotVolume</span> <span class='hs-conid'>[]</span> <span class='hs-layout'>(</span><span class='hs-str'>"#comment-"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>toValue</span> <span class='hs-varop'>.</span> <span class='hs-varid'>unId</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationCommentId</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-str'>"commented"</span>
<a name="line-226"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" on "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-227"></a>  <span class='hs-conid'>NoticeCommentReply</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-228"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>slotVolume</span> <span class='hs-conid'>[]</span> <span class='hs-layout'>(</span><span class='hs-str'>"#comment-"</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>toValue</span> <span class='hs-varop'>.</span> <span class='hs-varid'>unId</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationCommentId</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-str'>"replied"</span>
<a name="line-229"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" to your comment on "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-230"></a>  <span class='hs-conid'>NoticeTagVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-231"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>slotVolume</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-str'>"tag"</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldMap</span> <span class='hs-layout'>(</span><span class='hs-varid'>tagNameBS</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tagName</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationTag</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-str'>"#panel-tags"</span><span class='hs-layout'>)</span> <span class='hs-str'>"tagged"</span>
<a name="line-232"></a>    <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" with "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>em</span> <span class='hs-layout'>(</span><span class='hs-varid'>mapM_</span> <span class='hs-layout'>(</span><span class='hs-varid'>byteStringHtml</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tagNameBS</span> <span class='hs-varop'>.</span> <span class='hs-varid'>tagName</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationTag</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-233"></a>  <span class='hs-conid'>NoticeSharedVolume</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-234"></a>    <span class='hs-varid'>agent</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" shared "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>volume</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"."</span>
<a name="line-235"></a>  <span class='hs-conid'>NoticeNewsletter</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-236"></a>    <span class='hs-str'>"A new "</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>a</span> <span class='hs-conid'>H</span><span class='hs-varop'>.!</span> <span class='hs-conid'>HA</span><span class='hs-varop'>.</span><span class='hs-varid'>href</span> <span class='hs-str'>"//databrary.org/news.html"</span><span class='hs-layout'>)</span> <span class='hs-str'>"Databrary newsletter"</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>" has been posted."</span>
<a name="line-237"></a>  <span class='hs-keyword'>where</span>
<a name="line-238"></a>  <span class='hs-varid'>target</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partyRow</span> <span class='hs-layout'>(</span><span class='hs-varid'>accountParty</span> <span class='hs-varid'>notificationTarget</span><span class='hs-layout'>)</span>
<a name="line-239"></a>  <span class='hs-varid'>person</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>on</span> <span class='hs-layout'>(</span><span class='hs-varop'>/=</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyId</span> <span class='hs-varid'>p</span> <span class='hs-varid'>target</span><span class='hs-layout'>)</span> <span class='hs-varop'>`thenUse`</span> <span class='hs-layout'>(</span><span class='hs-varid'>htmlPartyViewLink</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-240"></a>  <span class='hs-varid'>agent</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-str'>"You"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>person</span> <span class='hs-varid'>notificationAgent</span>
<a name="line-241"></a>  <span class='hs-varid'>partyp</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>any</span> <span class='hs-layout'>(</span><span class='hs-varid'>on</span> <span class='hs-layout'>(</span><span class='hs-varop'>/=</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyId</span> <span class='hs-varid'>notificationAgent</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationParty</span><span class='hs-layout'>)</span> <span class='hs-varop'>`thenUse`</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>person</span> <span class='hs-varop'>=&lt;&lt;</span> <span class='hs-varid'>notificationParty</span>
<a name="line-242"></a>  <span class='hs-varid'>party</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>"you"</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-str'>"themselves"</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyp</span>
<a name="line-243"></a>  <span class='hs-varid'>party'sOr</span> <span class='hs-varid'>your</span> <span class='hs-varid'>their</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>your</span> <span class='hs-layout'>(</span><span class='hs-varid'>maybe</span> <span class='hs-varid'>their</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;&gt;</span> <span class='hs-str'>"'s"</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>partyp</span>
<a name="line-244"></a>  <span class='hs-varid'>party's</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>party'sOr</span> <span class='hs-str'>"your"</span> <span class='hs-str'>"their own"</span>
<a name="line-245"></a>  <span class='hs-varid'>party'S</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>party'sOr</span> <span class='hs-str'>"Your"</span> <span class='hs-str'>"Their own"</span>
<a name="line-246"></a>  <span class='hs-varid'>personq</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"party"</span><span class='hs-layout'>,</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>""</span> <span class='hs-layout'>(</span><span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>partyId</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-247"></a>  <span class='hs-varid'>partyq</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>personq</span> <span class='hs-varid'>notificationParty</span>
<a name="line-248"></a>  <span class='hs-varid'>link</span> <span class='hs-varid'>u</span> <span class='hs-varid'>a</span> <span class='hs-varid'>q</span> <span class='hs-varid'>h</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>a</span> <span class='hs-conid'>H</span><span class='hs-varop'>.!</span> <span class='hs-varid'>actionLink</span> <span class='hs-varid'>u</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>second</span> <span class='hs-conid'>Just</span><span class='hs-layout'>)</span> <span class='hs-varid'>q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>h</span>
<a name="line-249"></a>  <span class='hs-varid'>partyEdit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>partyEditLink</span> <span class='hs-varid'>link</span> <span class='hs-varid'>target</span>
<a name="line-250"></a>  <span class='hs-varid'>granted</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>"revoked"</span> <span class='hs-layout'>(</span><span class='hs-varid'>const</span> <span class='hs-str'>"granted"</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationPermission</span>
<a name="line-251"></a>  <span class='hs-varid'>volume</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-str'>"&lt;VOLUME&gt;"</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>htmlVolumeViewLink</span> <span class='hs-varid'>v</span> <span class='hs-layout'>(</span><span class='hs-conid'>[]</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Query</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>notificationVolume</span>
<a name="line-252"></a>  <span class='hs-varid'>volumeEdit</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>link</span> <span class='hs-varid'>viewVolumeEdit</span> <span class='hs-layout'>(</span><span class='hs-varid'>maybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>volumeId</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>)</span>
<a name="line-253"></a>  <span class='hs-varid'>perm</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-conid'>PermissionNONE</span> <span class='hs-varid'>notificationPermission</span>
<a name="line-254"></a>  <span class='hs-varid'>slot</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Id</span> <span class='hs-varop'>$</span> <span class='hs-conid'>SlotId</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>notificationContainerId</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>fullSegment</span> <span class='hs-varid'>notificationSegment</span><span class='hs-layout'>)</span>
<a name="line-255"></a>  <span class='hs-varid'>assetSegment</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>link</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewAssetSegment</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span><span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromMaybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>notificationAssetId</span><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span>
<a name="line-256"></a>  <span class='hs-varid'>slotVolume</span> <span class='hs-varid'>q</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span><span class='hs-varop'>.</span><span class='hs-varid'>a</span> <span class='hs-conid'>H</span><span class='hs-varop'>.!</span> <span class='hs-conid'>HA</span><span class='hs-varop'>.</span><span class='hs-varid'>href</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>isJust</span> <span class='hs-varid'>notificationContainerId</span>
<a name="line-257"></a>    <span class='hs-keyword'>then</span> <span class='hs-varid'>actionValue</span> <span class='hs-layout'>(</span><span class='hs-varid'>viewSlot</span> <span class='hs-conid'>False</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varid'>volumeId</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>,</span> <span class='hs-varid'>slot</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>q</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>,</span> <span class='hs-conid'>BSC</span><span class='hs-varop'>.</span><span class='hs-conid'>ByteString</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>t</span>
<a name="line-258"></a>    <span class='hs-keyword'>else</span> <span class='hs-varid'>actionValue</span> <span class='hs-varid'>viewVolume</span> <span class='hs-layout'>(</span><span class='hs-conid'>HTML</span><span class='hs-layout'>,</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>noId</span> <span class='hs-varid'>volumeId</span> <span class='hs-varid'>notificationVolume</span><span class='hs-layout'>)</span> <span class='hs-varid'>q</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-259"></a>
<a name="line-260"></a><a name="noId"></a><span class='hs-definition'>noId</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-layout'>(</span><span class='hs-conid'>IdType</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Id</span> <span class='hs-varid'>a</span>
<a name="line-261"></a><span class='hs-definition'>noId</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Id</span> <span class='hs-varop'>$</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
</pre></body>
</html>
